<h1>Admin</h1>

<div class="form-group">
  <%= link_to 'Pages', admin_pages_path, class: 'btn btn-secondary btn-sm' %>
</div>

<h4><%= @page.title %></h4>

<table class="table table-striped table-sm">
  <thead>
    <tr>
      <th>Version</th>
      <th>Title</th>
      <th>Flags</th>
      <th>Updated</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @revisions.each do |revision| %>
      <tr id="<%= dom_id revision %>">
        <td><%= revision.version %></td>
        <td class="w-50"><%= revision.title %></td>
        <td>
          <% if revision.published? %>
            <% if @page.synced? %>
              <span class="badge badge-success">published</span>
            <% else %>
              <span class="badge badge-danger">published</span>
            <% end %>
          <% end %>
          <% if revision.latest? %>
            <span class="badge badge-info">latest</span>
          <% end %>
        </td>
        <td><%= l revision.updated_at, format: '%F %T' %></td>
        <td>
          <% if revision.published? %>
            <%= link_to 'Unpublish', unpublish_admin_page_path(@page), class: 'btn btn-secondary btn-sm', method: :patch %>
          <% else %>
            <%= link_to 'Publish', publish_admin_page_path(@page, version: revision.version), class: 'btn btn-info btn-sm', method: :patch %>
          <% end %>
          <%= link_to 'Preview', preview_admin_page_path(@page, version: revision.version), class: 'btn btn-link btn-sm' if @page.preview? %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= paginate @revisions, views_prefix: 'admin' %>
